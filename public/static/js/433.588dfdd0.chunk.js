"use strict";(self.webpackChunksocial_network_app=self.webpackChunksocial_network_app||[]).push([[433],{2896:(e,s,o)=>{o.d(s,{o:()=>c});var l=o(8683),i=o(1363),n=o(2791),a=o(1672),t=o(9722),d=o(184);const c=e=>{let{toggleShowCreatePost:s,onAddPost:o,isShowCreatePost:c,loggedInUser:r}=e;const[m,u]=(0,n.useState)({body:"",imgBodyUrl:null,videoBodyUrl:null,link:"",title:"",style:{textAlign:"ltr"}}),[p,h]=(0,n.useState)(!1),g=async e=>{const s=e.target.name;let o="number"===e.target.type?+e.target.value||"":e.target.value;u((e=>(0,l.Z)((0,l.Z)({},e),{},{[s]:o})))};(0,n.useEffect)((()=>()=>{u(null)}),[]);return(0,d.jsx)("section",{className:c?" create-post-modal":"hide create-post-modal",onClick:e=>{e.stopPropagation(),s()},children:(0,d.jsxs)("form",{className:"container",onSubmit:e=>{e.preventDefault(),o(m)},onClick:e=>{e.stopPropagation()},children:[(0,d.jsxs)("div",{className:"title",children:[(0,d.jsx)("h1",{children:"Create a post"}),(0,d.jsx)("span",{className:"close-icon",onClick:s,children:(0,d.jsx)(i.G,{icon:"fa-solid fa-x"})})]}),(0,d.jsxs)("div",{className:"name-container",children:[(0,d.jsx)("div",{className:"img-container",children:(0,d.jsx)("img",{src:null===r||void 0===r?void 0:r.imgUrl,alt:"",className:"img-profile"})}),(0,d.jsx)("div",{className:"name",children:(0,d.jsx)("h2",{children:null===r||void 0===r?void 0:r.fullname})})]}),(0,d.jsx)("div",{className:"input-container",children:(0,d.jsx)("textarea",{required:!0,ref:e=>{e&&e.focus()},onChange:g,type:"text",id:"body",name:"body",value:m.txt,placeholder:"What do you want to talk about?"})}),(0,d.jsx)("div",{className:"link-container",children:(0,d.jsx)("input",{id:"link",name:"link",value:m.link,onChange:g,type:"text",placeholder:"Add a link here"})}),(0,d.jsx)("div",{className:"is-loading-container",children:(0,d.jsx)("p",{children:p&&(0,d.jsx)("span",{children:(0,d.jsx)("img",{src:t,alt:""})})})}),(0,d.jsx)("div",{className:"container-video-body",children:(0,d.jsx)("div",{className:"body-video",children:m.videoBodyUrl&&(0,d.jsx)("video",{width:"100%",height:"300",controls:!0,children:(0,d.jsx)("source",{src:m.videoBodyUrl,type:"video/mp4"})})})}),(0,d.jsx)("div",{className:"container-img-body",children:(0,d.jsx)("div",{className:"body-img",children:m.imgBodyUrl&&(0,d.jsx)("img",{src:m.imgBodyUrl,alt:"",className:"img"})})}),(0,d.jsxs)("div",{className:"btns-add-container",children:[(0,d.jsx)("div",{className:"cancel-btn btn",onClick:()=>{u({body:"",imgBodyUrl:null,videoBodyUrl:null,title:"",style:{textAlign:"ltr"}}),s()},children:"Cancel"}),!m.videoBodyUrl&&(0,d.jsx)("div",{className:"add-video-btn btn",children:(0,d.jsxs)("label",{htmlFor:"videoUrl",className:"add-video-container",children:[(0,d.jsx)("input",{onChange:async e=>{try{h(!0);const s=await(0,a.u)(e);h(!1),u((e=>(0,l.Z)((0,l.Z)({},e),{},{videoBodyUrl:s.url})))}catch(s){h(!1),console.log(s)}},id:"videoUrl",type:"file",name:"videoUrl",accept:"video/*",hidden:!0}),(0,d.jsx)("p",{className:"add-video-body",children:"Add video"})]})}),!m.imgBodyUrl&&(0,d.jsx)("div",{className:"add-img-btn btn",children:(0,d.jsxs)("label",{htmlFor:"imgUrl",className:"add-img-container",children:[(0,d.jsx)("input",{onChange:async e=>{try{h(!0);const s=await(0,a.T)(e);h(!1),u((e=>(0,l.Z)((0,l.Z)({},e),{},{imgBodyUrl:s.url})))}catch(s){h(!1),console.log(s)}},id:"imgUrl",type:"file",name:"imgUrl",accept:"image/*",hidden:!0}),(0,d.jsx)("p",{className:"add-img-body",children:"Add photo"})]})}),(0,d.jsx)("button",{className:"post-btn btn",children:"Done"})]})]})})}},9334:(e,s,o)=>{o.d(s,{O:()=>d});var l=o(2791),i=o(1363),n=o(8931),a=o(8874),t=o(184);function d(e){let{toggleShowImg:s,imgUrl:o,videoUrl:d,title:c,post:r,body:m}=e;const u=(0,n.k6)(),[p,h]=(0,l.useState)(null);return(0,l.useEffect)((()=>{null!==r&&void 0!==r&&r.userId&&(async e=>{const s=await a.W.getById(e);h(s)})(r.userId)}),[]),(0,t.jsxs)("div",{className:"img-profile-preview",children:[(0,t.jsx)("div",{className:"bg",onClick:s}),(0,t.jsxs)("section",{className:"container",children:[(0,t.jsxs)("div",{className:"title",children:[p&&r&&(0,t.jsxs)("div",{className:"user-details",onClick:()=>u.push("/main/profile/".concat(r.userId)),children:[(0,t.jsx)("img",{src:p.imgUrl,alt:"",className:"img"}),(0,t.jsx)("p",{className:"fullname",children:p.fullname})]})||r&&(0,t.jsx)("p",{className:"user-details",children:"Loading user..."}),(0,t.jsx)("p",{children:c}),(0,t.jsx)("span",{className:"logo-close",onClick:s,children:(0,t.jsx)(i.G,{icon:"fa-solid fa-x"})})]}),m&&(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"body",children:m})}),r&&(0,t.jsx)("div",{className:"see-post",children:(0,t.jsx)("p",{onClick:()=>u.push("/main/post/".concat(r.userId,"/").concat(r._id)),children:"See original post"})}),(0,t.jsx)("div",{className:"img-container",children:o&&(0,t.jsx)("img",{className:"img",src:o,alt:""})||d&&(0,t.jsx)("div",{children:(0,t.jsx)("video",{width:"100%",height:"300",controls:!0,children:(0,t.jsx)("source",{src:d,type:"video/mp4"})})})})]})]})}},7433:(e,s,o)=>{o.r(s),o.d(s,{default:()=>x});var l=o(8683),i=o(2791),n=o(2040),a=o(9434),t=o(8931),d=o(184);const c=e=>{let{url:s,userId:o,fullname:l,isCloseUserIcon:n}=e;const[a,c]=(0,i.useState)(!1),r=(0,t.k6)();return(0,i.useEffect)((()=>(n&&c(!1),()=>{})),[n]),(0,d.jsxs)("div",{className:"user-icon-pos-container",onClick:e=>{e.stopPropagation(),c((e=>!e))},children:[(0,d.jsx)("img",{className:"user-icon-pos",src:s,alt:l,title:l}),a&&(0,d.jsxs)("div",{className:"menu-container",children:[(0,d.jsxs)("div",{className:"opts-btns",children:[(0,d.jsx)("div",{className:"fullname ",children:(0,d.jsx)("p",{children:l})}),(0,d.jsx)("div",{className:"go-to-profile opt",onClick:()=>r.push("/main/profile/".concat(o)),children:(0,d.jsx)("p",{children:"Go to profile"})}),(0,d.jsx)("div",{className:"send-message opt",onClick:()=>r.push("/main/message/".concat(o)),children:(0,d.jsx)("p",{children:"Send a message"})})]}),(0,d.jsx)("div",{className:"close",onClick:e=>{e.stopPropagation(),c(!1)},children:(0,d.jsx)("span",{children:"Close"})})]})]})};var r=o(1363);const m=e=>{let{menuPosition:s,setIsCreateShowPost:o}=e;return(0,d.jsxs)("section",{className:"map-menu",children:[(0,d.jsx)("span",{className:"location-icon",children:(0,d.jsx)(r.G,{icon:"fa-solid fa-location-dot"})}),(0,d.jsx)("div",{className:"opts-container",children:(0,d.jsx)("div",{className:"add-post-to-map opt",onClick:()=>{o(!0)},children:(0,d.jsx)("p",{children:"Add a post here"})})})]})},u=e=>{let{post:s,setPostToPreview:o}=e;return(0,d.jsx)("section",{className:"post-icon-map",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsx)("div",{className:"logo-post-icon-map-container",onClick:()=>o(s),children:(0,d.jsx)("span",{className:"img-logo",children:s.imgBodyUrl&&(0,d.jsx)("img",{src:s.imgBodyUrl,alt:"",className:"img"})||s.videoBodyUrl&&(0,d.jsx)("p",{children:(0,d.jsx)("span",{className:"post-logo",children:(0,d.jsx)(r.G,{icon:"fa-solid fa-video"})})})||(0,d.jsx)("p",{children:(0,d.jsx)("span",{className:"post-logo",children:(0,d.jsx)(r.G,{icon:"fa-solid fa-comment-dots"})})})})})})})};var p=o(9334),h=o(2896),g=o(262),v=o(4029);const x=function(){const e=(0,a.I0)(),[s,o]=(0,i.useState)({center:{lat:32.05591645013164,lng:34.7549857056555},zoom:2,yesIWantToUseGoogleMapApiInternals:!0}),[t,r]=(0,i.useState)(!1),[x,j]=(0,i.useState)(!1),[y,N]=(0,i.useState)(null),[f,U]=(0,i.useState)(!1),[b,w]=(0,i.useState)(!1),{loggedInUser:C}=(0,a.v9)((e=>e.userModule)),{users:k}=(0,a.v9)((e=>e.userModule)),{posts:I}=(0,a.v9)((e=>e.postModule));(0,i.useEffect)((()=>{e((0,g.rd)("map"));const s={position:"position"};return e((0,v.uQ)(s)),e((0,v.Rf)()),e((0,g.L6)(s)),e((0,g.Nz)()),navigator.geolocation?navigator.geolocation.getCurrentPosition(P):console.log("Geolocation is not supported by this browser."),()=>{e((0,g.L6)(null)),e((0,v.uQ)(null))}}),[]);const S=()=>{w((e=>!e))};function P(s){const o={lat:s.coords.latitude,lng:s.coords.longitude};s&&(s=>{C&&e((0,v.Nq)((0,l.Z)((0,l.Z)({},C),{},{position:s})))})(o)}const B=e=>{const s={lat:e.lat,lng:e.lng};r((e=>!e)),N(s),j((e=>!e))};return(0,d.jsxs)("section",{className:"map-page ",children:[(0,d.jsx)("div",{className:"map",style:{height:"100%",width:"100%"},children:(0,d.jsxs)(n.ZP,{bootstrapURLKeys:{key:"AIzaSyC9AFUykGS85sRwdfagUSX3H2ib7relELI"},defaultCenter:s.center,defaultZoom:s.zoom,yesIWantToUseGoogleMapApiInternals:!0,onClick:e=>B(e),children:[k&&k.map((e=>{var s,o;return(0,d.jsx)(c,{lat:(null===e||void 0===e||null===(s=e.position)||void 0===s?void 0:s.lat)||32.05591645013164,lng:(null===e||void 0===e||null===(o=e.position)||void 0===o?void 0:o.lng)||34.7549857056555,url:e.imgUrl,userId:e._id,fullname:e.fullname,isCloseUserIcon:t},e._id)})),I&&I.map((e=>{var s,o;return(0,d.jsx)(u,{lat:null===e||void 0===e||null===(s=e.position)||void 0===s?void 0:s.lat,lng:null===e||void 0===e||null===(o=e.position)||void 0===o?void 0:o.lng,post:e,setPostToPreview:U},null===e||void 0===e?void 0:e._id)})),x&&y&&(0,d.jsx)(m,{menuPosition:y,lat:y.lat,lng:y.lng,setIsCreateShowPost:w})]})}),f&&(0,d.jsx)(p.O,{toggleShowImg:e=>{U(f?null:e)},title:f.title,body:f.body,imgUrl:f.imgBodyUrl,post:f,videoUrl:null===f||void 0===f?void 0:f.videoBodyUrl}),b&&(0,d.jsx)(h.o,{isShowCreatePost:b,onAddPost:s=>{const o=(0,l.Z)((0,l.Z)({},s),{},{userId:C._id,position:y});e((0,g.TJ)(o)).then((()=>S()))},toggleShowCreatePost:S,loggedInUser:C})]})}},1672:(e,s,o)=>{o.d(s,{T:()=>n,u:()=>a});var l=o(1732);const i=e=>new Promise(((s,o)=>{const l=new FileReader;l.readAsDataURL(e),l.onload=()=>s(l.result),l.onerror=e=>o(e)})),n=async e=>{try{const s=e.target.files[0];if(!s)throw new Error("No file selected");const o=await i(s);return await l.R.post("cloudinary/upload",{file:o,resourceType:"image"})}catch(s){throw console.error("Error uploading image:",null===s||void 0===s?void 0:s.message),s}},a=async e=>{try{const s=e.target.files[0];if(!s)throw new Error("No file selected");const o=await i(s);return await l.R.post("cloudinary/upload",{file:o,resourceType:"video"})}catch(s){throw console.error("Error uploading video:",null===s||void 0===s?void 0:s.message),s}}}}]);
//# sourceMappingURL=433.588dfdd0.chunk.js.map